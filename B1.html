<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "https://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="IE=7,IE=9, IE=10" http-equiv="X-UA-Compatible"/>
<meta content="initial-scale=1, maximum-scale=1,user-scalable=no" name="viewport"/>
<title>Iowa DNR - Livestock Burial</title>
<link href="https://js.arcgis.com/3.31/dijit/themes/nihilo/nihilo.css" rel="stylesheet"/>
<link href="https://js.arcgis.com/3.31/esri/css/esri.css" rel="stylesheet"/>
<link href="https://js.arcgis.com/3.31/dojox/layout/resources/FloatingPane.css" rel="stylesheet" type="text/css"/>
<link href="https://js.arcgis.com/3.31/dojox/layout/resources/ExpandoPane.css" rel="stylesheet" type="text/css"/>
<link href="https://js.arcgis.com/3.31/dojox/grid/resources/Grid.css" rel="stylesheet" type="text/css"/>
<link href="https://js.arcgis.com/3.31/dojox/grid/resources/nihiloGrid.css" rel="stylesheet" type="text/css"/>
<link href="https://js.arcgis.com/3.31/esri/dijit/css/Bookmarks.css" rel="stylesheet"/>
<link href="https://js.arcgis.com/3.31/esri/dijit/css/Popup.css" rel="stylesheet" type="text/css"/>
<link href="js/gov/iowadnr/compactmap/iowadnr/dijit/CustomInfoWindow/InfoWindow.css" rel="stylesheet"/>
<script src="https://programs.iowadnr.gov/maps/apis/proj4js/lib/proj4js-compressed.js" type="text/javascript"></script>
<script src="https://programs.iowadnr.gov/maps/apis/proj4js/lib/defs/EPSG4326.js" type="text/javascript"></script>
<script src="https://programs.iowadnr.gov/maps/apis/proj4js/lib/defs/EPSG102100.js" type="text/javascript"></script>
<script src="https://programs.iowadnr.gov/maps/apis/proj4js/lib/defs/EPSG26915.js" type="text/javascript"></script>
<script src="js/mustache/mustache.js" type="text/javascript"></script>
<script src="js/gov/iowadnr/compactmap/webmercatorbookmarks.js" type="text/javascript"></script>
<script src="js/gov/iowadnr/compactmap/AGOLBasemaps.js" type="text/javascript"></script>
<!--<script src="js/IdentifyWells.js" type="text/javascript"></script>
<script src="js/RastersIdentify.js" type="text/javascript"></script> -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-40048805-1"></script>
<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-40048805-1');
</script>
<script async="" defer="" src="//sliver.iowa.gov/sliver.js"></script>

<style> 
      html, body { height: 100%; width: 100%; margin: 0; padding: 0; } 
      
           .sectitle { font-weight:bold;text-decoration: underline;}
      .infotab {font-size: x-small;}
	  
	  #iowa_sliver_spacer {
      height: 5% !important;
      }

      #iowa_sliver #iowa_sliver_bar {
          height: 5%;
      }
	  #layerListDom{
		 position: absolute;
		 left: 75%;
		 top: 10%;
		 z-index: 50;
		}
	 #legend{
		position: absolute;
		 left: 80%;
		 top: 10%;
		 z-index: 50;
		 display: none; 
	 }
	#layerListDom_checkbox_0{}
	#numScale{
		font-size: 0.9em;
		color: #3F3F3F;
		//background-color:#c7942d !important;
	}
    </style>


<style media="print" type="text/css">
    	/*@media print {   */		
    		@page { 
    			size: landscape;
    			margin: 1cm;
    			/*-webkit-transform: rotate(-90deg);
				-moz-transform:rotate(-90deg);
				filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=3);*/
    	    }

			#header {display:none;}
			#footer {display:none;}
			#leftPane{display:none;}
			#pinDivPrint {
				page-break-before: always;
				display: block;
				font-size:x-small;
			}
			#p0p{float:left;}
			
		/*}*/
    </style>
<script type="text/javascript">
        var djConfig = {
          parseOnLoad: true,
          packages: [{   
		    "name": "agsjs",
            "location": location.pathname.replace(/\/[^/]+$/, '') + '/js/gov/iowadnr/compactmap/dijits/agsjs' 
          },
          {   
		    "name": "iowadnr",
            "location": location.pathname.replace(/\/[^/]+$/, '') + '/js/gov/iowadnr/compactmap/iowadnr' 
          }
             
          ]
        };
    </script>
<!--<script src="https://serverapi.arcgisonline.com/jsapi/arcgis/3.5/"></script> -->
<script src="https://js.arcgis.com/3.31compact/"></script>
<script type="text/javascript">
      dojo.require("dijit.dijit");
      dojo.require("esri.map");
      dojo.require("esri.dijit.Scalebar");
      dojo.require("esri.dijit.Popup");
      dojo.require("esri.tasks.locator");
	  
      dojo.require("esri.tasks.find");
      dojo.require("dojo.number");
      dojo.require("esri.layers.FeatureLayer");
      dojo.require("esri.layers.agsdynamic");
      dojo.require("dijit.layout.BorderContainer");
      dojo.require("dijit.layout.ContentPane");
      dojo.require("dijit.TitlePane");
      dojo.require("dijit.layout.AccordionContainer");
      dojo.require("dojox.layout.ExpandoPane");
      dojo.require("dojox.layout.FloatingPane");
      dojo.require("dijit.layout.TabContainer");
      dojo.require("esri.dijit.Bookmarks");
      dojo.require("esri.dijit.BasemapGallery");
      dojo.require("esri.dijit.Legend");
      dojo.require("esri.dijit.Measurement");
      dojo.require("esri.arcgis.utils");
      dojo.require("dijit.Tooltip");
      dojo.require("dijit.Dialog");
      dojo.require("dijit.form.Button");
      dojo.require("dijit.form.Slider");
      dojo.require("dijit.form.Textarea");
      dojo.require("dijit.form.CheckBox");
      dojo.require("dijit.form.TextBox");
      dojo.require("dijit.form.ValidationTextBox");
      dojo.require("dijit.form.Select");
      dojo.require("dijit.Menu");
      dojo.require("dojox.grid.DataGrid");
      dojo.require("dojo.data.ItemFileReadStore");
      dojo.require("dijit.Tooltip");
      dojo.require("dojo.fx.easing");
      dojo.require("dojo.DeferredList"); 
      dojo.require("dojo.cookie");
      dojo.require("agsjs.dijit.TOC");
      dojo.require("iowadnr.dijit.CustomInfoWindow.InfoWindow");
	  dojo.require("esri.tasks.identify");
	  dojo.require("dojo._base.array");
	  dojo.require("esri.dijit.LayerList");
	  //dojo.require("esri.layers.ArcGISDynamicMapServiceLayer");
     </script>
<script src="js/gov/iowadnr/compactmap/dnrcommon.js" type="text/javascript"></script>
<style type="text/css">
         /*@import "https://programs.iowadnr.gov/maps/apis/idnr/js/gov/iowadnr/compactmap/css/dnrtheme.css";*/
    	@import "js/gov/iowadnr/compactmap/css/dnrtheme.css";
     </style>
<script type="text/javascript">
      //var pin0,zoom;
	  let infoContent;
	  let wellInfo;
      var urlParams = dojo.queryToObject(window.location.search.slice(1));
      var map = null;
      var app = {};
      app.activepintool = "projecttool";
      
      //TO DO content 
      app.infowindowcontent = {"p0":"","p1":""};
      
      //var burialLayer;
      var x = -93.383;
      var y = 41.896;
      var infoWindow;
      var mapSpatialReferenceWKID = 102100;
      var mapSpatialReference;
      
      //OPTIONS to SET Below
      //See showAreaNameResults for example of markers on search
      var splash = true;
      var hasScalebar = true;
      var plssServiceUrl = "https://programs.iowadnr.gov/geospatial/rest/services/tools/plssLocator/MapServer";     
      var locatorServiceUrl = "https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer";
      var geometryServiceUrl = "https://programs.iowadnr.gov/geospatial/rest/services/Geometry/GeometryServer";
      var searchUrl = "https://programs.iowadnr.gov/arcgis/rest/services/Recreation/Hunting/MapServer";
      // var LAYERSCONFIG = [
                              // {'title':'AFO Siting Data',
                                     // 'serviceurl':'https://programs.iowadnr.gov/geospatial/rest/services/Agriculture/AnimalFeedingOperations/MapServer',
                                      // 'id':'afo','options':{'opacity':'1.0'},'imageParameters':{'imageFormat':'png32'}, 'includedlayers':[0,1,2,3,4,5,6,7,8,9,10,11,12], 'initialvislayers':[3], 'agsversion':'10.11'}                                 
      					      // ,{'title':'AFO Model/Support Data',
                                     // 'serviceurl':'https://programs.iowadnr.gov/geospatial/rest/services/Agriculture/AnimalFeedingOperations/MapServer',
                                      // 'id':'afomodel','options':{'opacity':'1.0'}, 'imageParameters':{'imageFormat':'png32'},'includedlayers':[13,14,15,16,17,18,19,20,21,22,23,24], 'initialvislayers':[24], 'agsversion':'10.11'}    
      					 // ];
    var OPLAYER = [{'title':'Regulatory Layer',
					'serviceurl':'https://programs.iowadnr.gov/geospatial/rest/services/Agriculture/Burial/MapServer',
					'id':'Soil',
					'options':{'opacity':'1.0'},
					'imageParameters':{'imageFormat':'png32'}, 
					'includedlayers':[2], 
					'initialvislayers':[2], 					
					'agsversion':'10.11'}];	
					
    var LAYERSCONFIG = [{'title':'Well Data',
                          'serviceurl':'https://programs.iowadnr.gov/geospatial/rest/services/OneStop/IaFmFacilities/MapServer',
                           'id':'wells','options':{'opacity':'1.0'}, 'imageParameters':{'imageFormat':'png32'},'includedlayers':[20,21,22,23,24,25,26,27,28], 'initialvislayers':[22,24], 'agsversion':'10.11'}        					 
                       ,{'title':'Burial Zone Data',
                           'serviceurl':'https://programs.iowadnr.gov/geospatial/rest/services/Agriculture/LivestockBurialZones/MapServer',
                            'id':'afo','options':{'opacity':'1.0'},'imageParameters':{'imageFormat':'png32'}, 'includedlayers':[0,1,2], 'initialvislayers':[0,1,2], 'agsversion':'10.11'}
						,{'title':'Regulatory Layer',
						'serviceurl':'https://programs.iowadnr.gov/geospatial/rest/services/Agriculture/Burial/MapServer',
						'id':'Soil',
						'options':{'opacity':'0.7'},
						'imageParameters':{'imageFormat':'png32'}, 
						'includedlayers':[2], 
						'initialvislayers':[], 					
						'agsversion':'10.11'}
						];
      					 				 
      					 
      app.IDENTIFYCONFIG = [{"serviceurl":"https://programs.iowadnr.gov/geospatial/rest/services/Agriculture/AnimalFeedingOperations/MapServer",
      						'identifylayers':[3,13,14,15,16,17,18,19,20,21,22,23,24]
      						},
      						{"serviceurl":"https://programs.iowadnr.gov/geospatial/rest/services/OneStop/IaFmFacilities/MapServer",
      						'identifylayers':[20,21,22,23,24,25,26,27,28],
							
      						"layerfieldmapping":[
      							//{layerId:0,fieldmap:{src:dst,src:dst}}
      							{layerId:20,layerName:"pws",fieldmap:{"stfacid":"pws_STFACID","opStatus":"pws_OPSTATUS","facName":"pws_FACNAME","Hyperlink":"pws_HYPER"}},
      						    {layerId:21,layerName:"wuse",fieldmap:{"stfacid":"wuse_STFACID","opStatus":"wuse_OPSTATUS","Hyperlink":"wuse_HYPER","MAPLABELNA":"wuse_FACNAME"}},
      						    {layerId:22,layerName:"pwts",fieldmap:{"stfacid":"pwts_STFACID","opStatus":"pwts_OPSTATUS","hyperlink":"pwts_HYPER","MAPLABELNA":"pwts_FACNAME","WellDepth":"pwts_WELLDEPTH","progid":"pwts_PROGID"}}
      							,{layerId:23,layerName:"watertreat",fieldmap:{"stfacid":"watertreat_STFACID","opStatus":"watertreat_OPSTATUS","Hyperlink":"watertreat_HYPER","MAPLABELNA":"watertreat_FACNAME"}}
      							,{layerId:24,layerName:"wellpublic",fieldmap:{"stfacid":"wellpublic_STFACID","opStatus":"wellpublic_OPSTATUS","Hyperlink":"wellpublic_HYPER","MAPLABELNA":"wellpublic_FACNAME",
      											"TotalDepth":"wellpublic_WELLDEPTH","progid":"wellpublic_PROGID"}}
      							,{layerId:25,layerName:"wellswuse",fieldmap:{"stfacid":"wellwuse_STFACID","opStatus":"wellwuse_OPSTATUS","Hyperlink":"wellwuse_HYPER",
      											"MAPLABELNA":"wellwuse_FACNAME","TotalDepth":"wellwuse_WELLDEPTH","progid":"wellwuse_PROGID"}}
      						    ,{layerId:26,layerName:"intakepub",fieldmap:{"stfacid":"intakepub_STFACID","opStatus":"intakepub_OPSTATUS","Hyperlink":"intakepub_HYPER",
      						    				"MAPLABELNA":"intakepub_FACNAME"}}
      							,{layerId:27,layerName:"intakewuse",fieldmap:{"stfacid":"intakewuse_STFACID","opStatus":"intakewuse_OPSTATUS","Hyperlink":"intakewuse_HYPER",
      											"MAPLABELNA":"intakewuse_FACNAME"}}
      							,{layerId:28,layerName:"allwells",fieldmap:{"WELLID":"all_WELLID","DEPTH":"all_WELLDEPTH","HLINK":"all_HYPER","DATASRC":"all_DATASRC"}}
      							
      						],
      					     "infotemplate":
      					     			"<table>" + 
      					     			"{{#pws_STFACID}}" +
      					     			"<tr><td colspan = '2' class='sectitle'>Public Water Supply</td></tr>"+
      					     			"<tr><td colspan = '2'><a href='{{pws_HYPER}}' target='_blank'>{{pws_FACNAME}}</a> </td></tr>" +
      					     			"<tr><td colspan = '2'>Operation Status: {{pws_OPSTATUS}}</td></tr>" +
      					     			"<tr><td colspan = '2'>&nbsp;</td></tr>" +
      					     			"{{/pws_STFACID}}" + 
      					     			
      					     			"{{#wuse_STFACID}}" +
      					     			"<tr><td colspan = '2' class='sectitle'>Water Use Facility</td></tr>"+
      					     			"<tr><td colspan = '2'><a href='{{wuse_HYPER}}' target='_blank'>{{wuse_FACNAME}}</a> </td></tr>" +
      					     			"<tr><td colspan = '2'>Operation Status: {{wuse_OPSTATUS}}</td></tr>" +
      					     			"<tr><td colspan = '2'>&nbsp;</td></tr>" +
      					     			"{{/wuse_STFACID}}" + 
      					     			
      					     			"{{#pwts_STFACID}}" +
      					     			"<tr><td colspan = '2' class='sectitle'>Private Well (PWTS)</td></tr>"+
      					     			"<tr><td colspan = '2'><a href='{{pwts_HYPER}}' target='_blank'>{{pwts_FACNAME}}</a> </td></tr>" +
      					     			"<tr><td colspan = '2'>Operation Status: {{pwts_OPSTATUS}}</td></tr>" +
      					     			"<tr><td colspan = '2'>Program ID: {{pwts_PROGID}}</td></tr>" +
      					     			"<tr><td colspan = '2'>Well Depth: {{pwts_WELLDEPTH}}</td></tr>" +
      					     			"<tr><td colspan = '2'>&nbsp;</td></tr>" +
      					     			"{{/pwts_STFACID}}" + 
      					     			
      					     			"{{#watertreat_STFACID}}" +
      					     			"<tr><td colspan = '2' class='sectitle'>Water Treatment</td></tr>"+
      					     			"<tr><td colspan = '2'><a href='{{watertreat_HYPER}}' target='_blank'>{{watertreat_FACNAME}}</a> </td></tr>" +
      					     			"<tr><td colspan = '2'>Operation Status: {{watertreat_OPSTATUS}}</td></tr>" +
      					     			"<tr><td colspan = '2'>&nbsp;</td></tr>" +
      					     			"{{/watertreat_STFACID}}" + 
//       					     			
      		      					    "{{#wellpublic_STFACID}}" +
      					     			"<tr><td colspan = '2' class='sectitle'>Wells - Public</td></tr>"+
      					     			"<tr><td colspan = '2'><a href='{{wellpublic_HYPER}}' target='_blank'>{{wellpublic_FACNAME}}</a> </td></tr>" +
      					     			"<tr><td colspan = '2'>Operation Status: {{wellpublic_OPSTATUS}}</td></tr>" +
      					     			"<tr><td colspan = '2'>Program ID: {{wellpublic_PROGID}}</td></tr>" +
      					     			"<tr><td colspan = '2'>Well Depth: {{wellpublic_WELLDEPTH}}</td></tr>" +
      					     			"<tr><td colspan = '2'>&nbsp;</td></tr>" +
      					     			"{{/wellpublic_STFACID}}" + 			     			
//  
       		      					    "{{#wellwuse_STFACID}}" +
      					     			"<tr><td colspan = '2' class='sectitle'>Wells - Water Use</td></tr>"+
      					     			"<tr><td colspan = '2'><a href='{{wellwuse_HYPER}}' target='_blank'>{{wellwuse_FACNAME}}</a> </td></tr>" +
      					     			"<tr><td colspan = '2'>Operation Status: {{wwellwuse_OPSTATUS}}</td></tr>" +
      					     			"<tr><td colspan = '2'>Program ID: {{wellwuse_PROGID}}</td></tr>" +
      					     			"<tr><td colspan = '2'>Well Depth: {{wellwuse_WELLDEPTH}}</td></tr>" +
      					     			"<tr><td colspan = '2'>&nbsp;</td></tr>" +
      					     			"{{/wellwuse_STFACID}}" + 
// 
//       					     			
      					     			"{{#intakepub_STFACID}}" +
      					     			"<tr><td colspan = '2' class='sectitle'>Surface Water Intake - Public</td></tr>"+
      					     			"<tr><td colspan = '2'><a href='{{intakepub_HYPER}}' target='_blank'>{{intakepub_FACNAME}}</a> </td></tr>" +
      					     			"<tr><td colspan = '2'>Operation Status: {{intakepub_OPSTATUS}}</td></tr>" +
      					     			"<tr><td colspan = '2'>&nbsp;</td></tr>" +
      					     			"{{/intakepub_STFACID}}" + 
// 
     					     			"{{#intakewuse_STFACID}}" +
      					     			"<tr><td colspan = '2' class='sectitle'>Surface Water Intake - Water Use</td></tr>"+
      					     			"<tr><td colspan = '2'><a href='{{intakewuse_HYPER}}' target='_blank'>{{intakewuse_FACNAME}}</a> </td></tr>" +
      					     			"<tr><td colspan = '2'>Operation Status: {{intakewuse_OPSTATUS}}</td></tr>" +
      					     			"<tr><td colspan = '2'>&nbsp;</td></tr>" +
      					     			"{{/intakewuse_STFACID}}" +      					     			
//      					     			
      					     		    "{{#all_MAPID}}" +
      					     			"<tr><td colspan = '2' class='sectitle'>All Wells</td></tr>"+
										"<tr><td colspan = '2'>Well ID: {{all_WELLID}}</td></tr>" +
      					     			"<tr><td colspan = '2'><a href='{{all_HYPER}}' target='_blank'>{{pwts_FACNAME}}</a> </td></tr>" +
      					     			"<tr><td colspan = '2'>Data Source: {{all_DATASRC}}</td></tr>" +
      					     			"<tr><td colspan = '2'>Well Depth: {{all_WELLDEPTH}}</td></tr>" +
      					     			"<tr><td colspan = '2'>&nbsp;</td></tr>" +
      					     			"{{/all_MAPID}}" + 		
      					     			"</table>"  
      						}
							//,
							// {"serviceurl":"https://programs.iowadnr.gov/geospatial/rest/services/Agriculture/Burial/MapServer",
      						//'identifylayers':[3,4,5,6,7,8,9,10,11,12,13,14,15,16,13,14,15,16,17]
							//},
							
      						];     
      
      //END SET OPTIONS

      
      var pin0,zoompt, zoom, showpin; //URL Params
      var default_basemap="bmGray"; //NOT USED, bmRoads bmAerial bmHybrid bmGray bmTopo bmOSM
      var basemap_gallery,legend;
      var locator,identifyDijit,measureDijit;
      var selectionHandler, clickHandler,clickListener;
      var initialExtent;
      var showcoordinates = true;
      var maplayers = [];
   
      var findParams, plssFindTask;   


     var bluePin,redPin,orangePin,greenPin, markerSymbol,lineSymbol,polygonSymbol;

      function init() {
      	    mapSpatialReference = new esri.SpatialReference({"wkid":mapSpatialReferenceWKID});
      	    esri.config.defaults.geometryService = new esri.tasks.GeometryService(geometryServiceUrl);
          	markerSymbol = new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID, new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID, new dojo.Color([255,0,0]), 2), new dojo.Color([255,255,0,0.25]));
            lineSymbol  = new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID, new dojo.Color([255,0,0]), 2);
            polygonSymbol = new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_SQUARE, 10, new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID, new dojo.Color([255, 0, 0]), 1), new dojo.Color([0, 255, 0, 0.50]));
            bluePin = new esri.symbol.PictureMarkerSymbol({"angle":0,"xoffset":0,"yoffset":10,"type":"esriPMS","url":"https://static.arcgis.com/images/Symbols/Shapes/BluePin1LargeB.png","imageData":"iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAADImlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpCREZCRkY1M0QzMkMxMUUwQUU5NUVFMEYwMTY0NzUwNSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpCREZCRkY1NEQzMkMxMUUwQUU5NUVFMEYwMTY0NzUwNSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkJERkJGRjUxRDMyQzExRTBBRTk1RUUwRjAxNjQ3NTA1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkJERkJGRjUyRDMyQzExRTBBRTk1RUUwRjAxNjQ3NTA1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQg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","contentType":"image/png","width":24,"height":24});
      	    redPin = new esri.symbol.PictureMarkerSymbol({"angle":0,"xoffset":0,"yoffset":10,"type":"esriPMS","url":"https://static.arcgis.com/images/Symbols/Shapes/RedPin1LargeB.png","imageData":"iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAADImlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1MzA4NzI3NkQyN0MxMUUwQUU5NUVFMEYwMTY0NzUwNSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo1MzA4NzI3N0QyN0MxMUUwQUU5NUVFMEYwMTY0NzUwNSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjUzMDg3Mjc0RDI3QzExRTBBRTk1RUUwRjAxNjQ3NTA1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjUzMDg3Mjc1RDI3QzExRTBBRTk1RUUwRjAxNjQ3NTA1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQg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","contentType":"image/png","width":24,"height":24});
			orangePin = new esri.symbol.PictureMarkerSymbol({"angle":0,"xoffset":0,"yoffset":10,"type":"esriPMS","url":"https://static.arcgis.com/images/Symbols/Shapes/OrangePin1LargeB.png","imageData":"iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAADImlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowRTA4NDg4NEQyODExMUUwQUU5NUVFMEYwMTY0NzUwNSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowRTA4NDg4NUQyODExMUUwQUU5NUVFMEYwMTY0NzUwNSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkRBOTg5MTVCRDI4MDExRTBBRTk1RUUwRjAxNjQ3NTA1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkRBOTg5MTVDRDI4MDExRTBBRTk1RUUwRjAxNjQ3NTA1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQg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","contentType":"image/png","width":24,"height":24}); 
            greenPin = new esri.symbol.PictureMarkerSymbol({"angle":0,"xoffset":0,"yoffset":10,"type":"esriPMS","url":"https://static.arcgis.com/images/Symbols/Shapes/GreenPin1LargeB.png","imageData":"iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAADImlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpBQTQxMkU2NEQzMUUxMUUwQUU5NUVFMEYwMTY0NzUwNSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpBQTQxMkU2NUQzMUUxMUUwQUU5NUVFMEYwMTY0NzUwNSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkFBNDEyRTYyRDMxRTExRTBBRTk1RUUwRjAxNjQ3NTA1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkFBNDEyRTYzRDMxRTExRTBBRTk1RUUwRjAxNjQ3NTA1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQg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","contentType":"image/png","width":24,"height":24});
      	
      	infoWindow = new iowadnr.dijit.CustomInfoWindow.InfoWindow({
          domNode: dojo.create("div", null, dojo.byId("map"))
        });
      	
      	//if (splash){
	   //   dijit.byId("splash").show();
	    //};
	   
      	var toclayers = [];
      	var legendlayers = []; 
		var oplayer=[];
      	
	    if (urlParams['pin0']){
			 zoompt,zoom,showpin = getURLParamValues(urlParams);
		} else {
			zoom = getDefaultZoom();
      		zoompt = new esri.geometry.Point(x,y,new esri.SpatialReference({ wkid:4326 }));
			showpin = false;
		}
		
		initPlssSearchParams(plssServiceUrl,mapSpatialReference);
  	   		       
       
       for (lyr in LAYERSCONFIG) {
	      	lyr_info = LAYERSCONFIG[lyr];
	      	newlyr = new esri.layers.ArcGISDynamicMapServiceLayer(lyr_info.serviceurl,lyr_info.options);
	      	newlyr.setImageFormat(lyr_info.imageParameters.imageFormat,false);
	      	if (lyr_info.initialvislayers){
	      		newlyr.setVisibleLayers(lyr_info.initialvislayers);
	      	}
	      	maplayers.push(newlyr);
	        toclayers.push({'layer':maplayers[lyr],'title':lyr_info.title,'includedLayers':lyr_info.includedlayers, 'initialvislayers':lyr_info.initialvislayers, 'version':lyr_info.agsversion});
       		legendlayers.push({'layer': maplayers[lyr],'title':lyr_info.title});
			console.log(toclayers);			
       };    
       
	   for (lyr in OPLAYER) {
			var keyLayers =[]; 
			lyr_info = OPLAYER[lyr];
			//var newlyr1;
	      	newlyr1 = new esri.layers.ArcGISDynamicMapServiceLayer(lyr_info.serviceurl,lyr_info.options);
	      	newlyr1.setImageFormat(lyr_info.imageParameters.imageFormat,false);
	      	if (lyr_info.initialvislayers){
	      		newlyr1.setVisibleLayers(lyr_info.initialvislayers);
	      	}
	      	keyLayers.push(newlyr1);
			oplayer.push({'layer':keyLayers[lyr],'title':lyr_info.title,'includedLayers':lyr_info.includedlayers, 'initialvislayers':lyr_info.initialvislayers, 'version':lyr_info.agsversion});
	   }

          initialExtent = new esri.geometry.Extent({"xmin":-11046697,"ymin":4659284,"xmax":-9788237,"ymax":5602211,"spatialReference":{"wkid":102100}});
	      
	       map = new esri.Map("map", {
	          center: zoompt,
	          zoom: zoom,
	          spatialReference: new esri.SpatialReference({"wkid":mapSpatialReferenceWKID})
	          ,infoWindow: infoWindow,
			  zoom: 7
	        });
	      
			dojo.connect(map, "onLoad", function() {  
							  
					  clickListener = doIdentify;
				/////////////////////////
			
			/*
			oplayer =[{"url":"http://servicesbeta.esri.com/arcgis/rest/services/US_Counties_Antialiasing/MapServer",
				"id":"US_Counties_Antialiasing_2423",
				"visibility":true,
				"opacity":0.74,
				"title":"US_Counties_Antialiasing"}]
				//"baseMap":{"baseMapLayers":[{"id":"NatGeo_World_Map_9586","opacity":1,"visibility":true,"url":"http://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer"}],
				//"title":"National Geographic"},
				//"version":"1.6"

				
				oplayer ={
				  "operationalLayers": [
					{
					  "id": "3",
					  "layerType": "ArcGISMapServiceLayer",
					  "url": "https://programs.iowadnr.gov/geospatial/rest/services/Agriculture/Burial/MapServer",
					  "visibility": true,
					  "opacity": 1,
					  "title": "Regulatory Layer"
					}
				  ]
				} */
				
				var mLayer = new esri.layers.ArcGISDynamicMapServiceLayer(
				  "https://programs.iowadnr.gov/geospatial/rest/services/Agriculture/Burial/MapServer", 
				  {				
					id: "regulatory",
					visible: false
				  });
				mLayer.setVisibleLayers([2]);
				map.addLayers([mLayer]);
				
				//map.addLayer(newlyr1)//, { "visible": false});
				var layerList = new esri.dijit.LayerList({
					map: map,
					showLegend: true,
					visibility: true,
					//showSubLayers: false,
					showOpacitySlider: true
					//layers: [2],
					layers: [map.getLayer("regulatory")]
				  },"layerListDom");
				 layerList.startup();
				
				var legend = new esri.dijit.Legend({
					  map: map,
					}, "legend");
				  
				//legend.startup();
				document.getElementById("legend").style.display="block";
				
				
				//setTimeout(function(){ 
					//let layerListCheck=document.getElementById("layerListDom_checkbox_0");
					//layerListCheck.checked = false;					
				//}, 1000);
				
				
			  /////////////////////////////////
		
        	 });
        	 
        	 
	        //After Layers Added create, Legend,TOC and Measurement Tools
	        dojo.connect(map, 'onLayersAddResult', function(results) {
	             createTOC(toclayers);
	             createLegend(legendlayers);
	             addMeasurementWidget();
	             initIdentify(app.IDENTIFYCONFIG);
	             createIdentifyTasks(app.IDENTIFYCONFIG);
	             createBookmarks();          
	             addMailMapButton();
	             addSplashButton();
	             
	             dojo.connect(map, "onMouseMove", showCoordinates);
	             dojo.connect(map, "onMouseDrag", showCoordinates);
	             
	             
	             if (showpin){
	             	callIdentifyLatLon(zoompt);
	             }
	       });        	
	       
	       createBasemapGallery(default_basemap);
	       
	       if (hasScalebar){
	       	  var scalebar = new esri.dijit.Scalebar({
			  map:map,
			  attachTo:"bottom-left",
			  scalebarStyle: "ruler",
			  scalebarUnit: "english"
			  });
	       }    
		

		  locator = new esri.tasks.Locator(locatorServiceUrl);
	      dojo.connect(locator, "onAddressToLocationsComplete", showGeocodeResults);
			
          //Address Search Button
	      dojo.connect(dojo.byId('search-address'),'onclick',function(){
      			locateAddress();
    	  });
    	  //Address Search, Enter Key
    	  dojo.connect(dojo.byId('address'),'onkeydown',function(e) {
        		if(e.keyCode === 13){
      			locateAddress();
    	  }});
    	 
/////////////////////////////////////////////////////
  //search by projectID 
            dojo.connect(dojo.byId('searchProjectID'), 'onclick', function (evt) {
				evt.stopPropagation(); 
                if (document.getElementById("searchSiteByProjectID").value === '') alert("Please insert an afo project id into the left box");
                
				searcyByID();
            });
            
            function searcyByID() {
                
               // let featureLayer = new esri.layers.FeatureLayer("https://programs.iowadnr.gov/geospatial/rest/services/Agriculture/AnimalFeedingOperations/MapServer/3");
                let queryTask = new esri.tasks.QueryTask("https://programs.iowadnr.gov/geospatial/rest/services/Agriculture/AnimalFeedingOperations/MapServer/3");
                let query = new esri.tasks.Query();
                query.returnGeometry = true;
                let id = document.getElementById('searchSiteByProjectID').value;
                if (isNaN(id)){
                    alert('Site projectID must be a number!');
                }
                query.where = "progid = " + id
                //query.outSpatialReference = new SpatialReference(102100); //web mercator is the default SP.
                query.outFields = ["progid","facName","LocAddress","CityName","locZip","countyName"];
                //featureLayer.setDefinitionExpression()
                queryTask.execute(query,showResults);
            }

            function showResults(featureSet) {   
                 let infoTemplate = new esri.InfoTemplate("${progid}", "<b>Name</b> : ${facName}<br/><b>Address</b>: ${LocAddress}</br><b>County Name</b>:${countyName}");
                //remove all graphics on the maps graphics layer
                //map.graphics.clear();  //without this, map will not zoom to selected sites correctly
                //var resultFeatures = new FeatureSet();
                //Performance enhancer - assign featureSet array to a single variable.
                var resultFeatures = featureSet.features;
                if (resultFeatures.length == 0) {
                    alert("No facility site found, Please try a different facility id");
                    //dom.byId("queryResult").innerHTML = "No site found, please try a different search."
                }
                else {
                    if (resultFeatures.length > 1) {
                        alert('Should be only one result, check your project id');
                        return;
                    } else {
                        let graphic = resultFeatures[0];

                        //var graphic = new Graphic( resultFeatures[i].geometry,symbol);
                        graphic.setSymbol(redPin);
                        graphic.setInfoTemplate(infoTemplate); 
                        //Add graphic to the map graphics featureLayer.
                        map.graphics.add(graphic);
                        map.centerAndZoom(graphic.geometry, 16);
                    }
                }

                var handle = dojo.connect(map.graphics, "onMouseOver", function (evt) {
                     map.infoWindow.hide(); //hide previous infowindow first, if there is one
                    var g = evt.graphic;
                    map.infoWindow.setContent(g.getContent());
                    map.infoWindow.setTitle(g.getTitle());
                    map.infoWindow.show(evt.screenPoint, map.getInfoWindowAnchor(evt.screenPoint));
                  
                    //dojo.disconnect(handle); //this is important, otherwise, click event won't work properly. 
                });
                ////dojo.connect(map.graphics, "onMouseOut", function () { map.infoWindow.hide(); });
            }
  ////////////////////////////////////////////////		 
		  
    	  //PLSS Search event/find task
		  dojo.connect(dojo.byId('search-plss'),'onclick',function(){
      			locatePLSS();
    	  });
    	  
		  dojo.connect(dojo.byId('plss'),'onkeydown',function(e) {
			if(e.keyCode === 13){
			locatePLSS();
    	  }});
    	  
         initHideShowTabListener();
         dojo.connect(dijit.byId('map'),'resize',map,map.resize);	


        //map.infoWindow.resize(200,200);
        //map.infoWindow.setTitle("Siting Information");
		
		map.on("extent-change", function (evt) {
				var numscale = document.getElementById("numScale");
				numscale.innerHTML = "Current map scale = 1:" + Number(map.getScale().toFixed(2)).toLocaleString();
				if (map.getScale() < 50000) {
					//$('#scale').css({ 'background-color': 'blue', 'font-size': '1.0em' });
					//map.setMaxScale(20000);
					numscale.setAttribute("style","background-color:grey;")
				} else {
					//$('#scale').css({ 'background-color': 'black', 'font-size': '1em' });
					numscale.setAttribute("style","background-color:white;")
				}
				
			});

     }
	 
     function initHideShowTabListener(){
     	tabsVisible = true;
     	dojo.connect(dijit.byId('leftPane'),'toggle',function(e){
     		     	
     		if (tabsVisible){
     			dojo.query("#tabContainer").style('display','none');
            	tabsVisible = false;
     		}else{
     			dojo.query("#tabContainer").style('display','block');
            	tabsVisible = true;
     		}
     	});
     };
      function getDefaultZoom(){
     	if (window.innerWidth < 780){
	      		zoom = 4;
	      	} else if (window.innerWidth >= 780 && window.innerWidth < 1280){
	      		zoom = 5;
	      	}else if (window.innerWidth >= 1280){
	      		zoom = 6;
	      	}
	     return zoom;
     }
      function getURLParamValues(urlParams){
       	  xy = urlParams['pin0'].split(",");
       	  if(urlParams['pin0']){
       	  	 showpin = true;
       	  }else{
       	  	 showpin = false;
       	  }      	  
		  if (urlParams['z'])
			  {
			  	zoom = urlParams['z'];
			  }else{
			  	zoom = 5;
			  }
		  if ( xy[0] > -180 && xy[0]< 180 && xy[1] > 0 && xy[1]< 90  ){
		  	//tpt = transformCoordinate('EPSG:4326','EPSG:102100',xy[0],xy[1]);
		  	//zoompt = new esri.geometry.Point(tpt.x,tpt.y,new esri.SpatialReference({ wkid:102100})); 
		  	zoompt = new esri.geometry.Point(xy[0],xy[1],new esri.SpatialReference({ wkid:4326})); 
		  }else{
		  	console.error("coordinates not recognized");
		  }
		  return zoompt,zoom,showpin;
      };

      function createLegend(legendlayers){
      	legend = new esri.dijit.Legend(
      		{
	  			map:map
	  		    ,layerInfos: legendlayers.reverse()
	  		},
	  			"legendDiv"
  			);
			legend.startup();	
      };
   function createTOC(toclayers){
      	mapTOC = new agsjs.dijit.TOC(
        	{   
	            map: map,
	            layerInfos: toclayers
	                    },
	             "tocDiv");
	    mapTOC.startup();
	    dojo.connect(mapTOC, 'onLoad', function(){
	    	     hideTOCLayers(toclayers);
				 }); 
       }
    function hideTOCLayers(toclayers){
      	for (i in toclayers){				
      		 for (j in toclayers[i].layer.layerInfos){
      		 	 if (toclayers[i].includedLayers.indexOf(parseInt(j)) == -1){
      		 	 		mapTOC.findTOCNode(toclayers[i].layer,j).hide();
      		 	 }
      		 } 
      	}
      }        
      function initPlssSearchParams(plssServiceUrl, mapSpatialReference){
      	plssFindTask = new esri.tasks.FindTask(plssServiceUrl);
      	findParams = new esri.tasks.FindParameters();
      	//findParams.outSpatialReference = new esri.SpatialReference({"wkid":mapSpatialReference});
		findParams.outSpatialReference = mapSpatialReference;
		findParams.returnGeometry = true;
		findParams.layerIds = [1];
		findParams.searchFields = ["TRSQQQ"];
      };
      function locatePLSS() {
        findParams.searchText = dojo.byId("plss").value;
        if (findParams.searchText){
        	plssFindTask.execute(findParams, showPlssResults, noPlssResults);
        } else {
        	map.graphics.clear();
        }
      }
      function noPlssResults(error){
      	map.graphics.clear();
      	alert("Please enter a valid Township, Range and Section");
      };
      function showPlssResults(results){
      	if (results.length>0){
	      	map.graphics.clear(); 
	        dojo.forEach(results, function(result) {
	          var graphic = result.feature;
	          switch (graphic.geometry.type) {
	          case "point":
	            graphic.setSymbol(markerSymbol);
	            break;
	          case "polyline":
	            graphic.setSymbol(lineSymbol);
	            break;
	          case "polygon":
	            graphic.setSymbol(polygonSymbol);
	            break;
	          }
	
	          map.graphics.add(graphic);
	        });
	         map.setExtent(esri.graphicsExtent(map.graphics.graphics).expand(1.5));
       }else{
       	alert("No location found");
       };
      };

    // function initIdentify(IDENTIFYCONFIG){
      	// identifyconfiguration = IDENTIFYCONFIG[0];
        // identifyTask = new esri.tasks.IdentifyTask(identifyconfiguration.serviceurl);
        // identifyParams = new esri.tasks.IdentifyParameters();
        // identifyParams.tolerance = 3;
        // identifyParams.spatialReference = new esri.SpatialReference({"wkid":mapSpatialReferenceWKID});
        // identifyParams.returnGeometry = true;
        // identifyParams.layerIds = identifyconfiguration.identifylayers;
        // identifyParams.layerOption = esri.tasks.IdentifyParameters.LAYER_OPTION_ALL;
        // identifyParams.width  = map.width;
        // identifyParams.height = map.height;
        // clickHandler = dojo.connect(map, "onClick", doIdentify);
      // }
    // function doIdentify(evt) {
        // map.graphics.clear();
        // identifyParams.geometry = evt.mapPoint;
        // identifyParams.mapExtent = map.extent;
        // identifyTask.execute(identifyParams, function(idResults) { addToMap(idResults); });
      // }
        
    function initIdentify(params){
    	//clickHandler = dojo.connect(map, "onClick", doIdentify);
		//map.on("click", doIdentify2);
		
		clickHandler = dojo.connect(map, "onClick", function(evt){
			evt.stopPropagation();
			doIdentify2(evt);
			doIdentify(evt);
			//IdentifyWells(evt);
		}) 
    }
      
    function pinIdentify(pinpoint) {
        if (app.activepintool){ 
			console.log(app.TASKs);
			var deferredTasks = dojo.map(app.TASKS, function (task) {
         	        var dt = new dojo.Deferred();
                    return dt;
                }); 
			console.log(app.TASKs);
        var deferredTasksList = new dojo.DeferredList(deferredTasks);
        
      	deferredTasksList.then(showResults);//chain showResults onto your DeferredList
        
        identifyParams = new esri.tasks.IdentifyParameters();
        identifyParams.tolerance = 3;
        identifyParams.returnGeometry = false;
        identifyParams.layerOption = esri.tasks.IdentifyParameters.LAYER_OPTION_ALL;
        identifyParams.spatialReference = new esri.SpatialReference({"wkid":app.mapSpatialReferenceWKID});
        identifyParams.geometry = pinpoint;
        identifyParams.width  = map.width;
        identifyParams.height = map.height;
        identifyParams.mapExtent = map.extent;
        
       for (i=0;i<app.TASKS.length;i++) { //Use 'for' instead of 'for...in' so you can sync tasks with defTasks
                    try {
                    	identifyParams.layerIds = app.IDENTIFYCONFIG[i].identifylayers;
                        app.TASKS[i].execute(identifyParams, deferredTasks[i].callback, deferredTasks[i].errback); //Execute each task
                    } catch (e) {
                        console.log("Error caught");
                        console.log(e);
                        deferredTasks[i].errback(e); //If you get an error for any task, execute the errback
                    }
                }
        }
      }


    function doIdentify(evt) {
	   if (map.getScale() > 50000) {
			alert("Please zoom in until you see the current map scale at bottom center\nturns grey or the scale bar showing 0.4mi or smaller; then click to see result.");
			return;
		};
        if (app.activepintool){ 
			console.log(app.TASKS);
        var deferredTasks = dojo.map(app.TASKS, function (task) {
         	        var dt = new dojo.Deferred();
                    return dt;
                }); 
        var deferredTasksList = new dojo.DeferredList(deferredTasks);
        
      	deferredTasksList.then(showResults);//chain showResults onto your DeferredList
        
        identifyParams = new esri.tasks.IdentifyParameters();
        identifyParams.tolerance = 3;
        identifyParams.returnGeometry = true;
        identifyParams.layerOption = esri.tasks.IdentifyParameters.LAYER_OPTION_ALL;
        identifyParams.spatialReference = new esri.SpatialReference({"wkid":app.mapSpatialReferenceWKID});
        identifyParams.geometry = evt.mapPoint;
        identifyParams.width  = map.width;
        identifyParams.height = map.height;
        identifyParams.mapExtent = map.extent;
        
       for (i=0;i<app.TASKS.length;i++) { //Use 'for' instead of 'for...in' so you can sync tasks with defTasks
                    try {
                    	identifyParams.layerIds = app.IDENTIFYCONFIG[i].identifylayers;
						if (i==1) {
							identifyParams.spatialReference = new esri.SpatialReference({"wkid":102100});
							//var mp = evt.mapPoint; 
							//identifyParams.geometry = transformCoordinate('EPSG:102100','EPSG:26915',mp.x,mp.y);
						}
                        app.TASKS[i].execute(identifyParams, deferredTasks[i].callback, deferredTasks[i].errback); //Execute each task
                    } catch (e) {
                        console.log("Error caught");
                        console.log(e);
                        deferredTasks[i].errback(e); //If you get an error for any task, execute the errback
                    }
                }
        }
		
      }


     function createIdentifyTasks(items)
      {
		console.log(items);
      	var tasks = new dojo.map(items,function(item)
      	 {
      		return new esri.tasks.IdentifyTask(item.serviceurl);
      	 });

      	 app.TASKS = tasks;
      	 
      }
      
	  function callIdentifyLatLon(pt) {
		map.graphics.clear(); 
		tpt = transformCoordinate('EPSG:4326','EPSG:102100',pt.x,pt.y);
		pinpt = new esri.geometry.Point(tpt.x,tpt.y,new esri.SpatialReference({ wkid:102100})); 		
		pinIdentify(pinpt);
      }

      //function addToMap(idResults) {
      function afoModelContent(idResults){
        afofac = {lid:3,displayFieldName:null,features:[],value:null};
        afodb ={lid:3,displayFieldName:null,features:[],value:null};
        distadw = {lid:13,displayFieldName:null,features:[],value:"1 mile or more"};
        distwell = {lid:14,displayFieldName:null,features:[],value:null};
        disthqr= {lid:15,displayFieldName:null,features:[],value:null};        
        distmajorsrcriver = {lid:16,displayFieldName:null,features:[],value:null};
        distmajorsrclake= {lid:17,displayFieldName:null,features:[],value:null};
        distwatersrc = {lid:18,displayFieldName:null,features:[],value:null};
        distpublicuseland= {lid:19, displayFieldName:null,features:[],value:null};
        wetland = {lid:20,displayFieldName:null,features:[],value:"> 2500 ft."};
        alluvial = {lid:25,displayFieldName:null,features:[],value:"No"};
        distkarst = {lid:21,displayFieldName:null,features:[],value:null};
        pctslope = {lid:22,displayFieldName:null,features:[],value:null};
        burialvalue = {lid:23,displayFieldName:null,features:[],value:null};

        for (var i=0, il=idResults.length; i<il; i++) {
          var idResult = idResults[i];
     	  var value = "> 1 mile";

          switch (idResult.layerId){
          	case 3:
          	  if(!afofac.displayFieldName){afofac.displayFieldName = idResult.layerName;};
          	  	afofac.features.push(idResult.feature);       
             if (idResult.feature.attributes["stfacid"]){ 
		  		 afofac.value = idResult.feature.attributes["stfacid"];
		  		 afodb.value = idResult.feature.attributes["progid"];
		  	 }     
          	  
          	break;
          	
          	case 13:
          	  if (!distadw.displayFieldName) {distadw.displayFieldName = idResult.layerName;};
              distadw.features.push(idResult.feature);
              
             if (idResult.feature.attributes["Pixel Value"]){
		  		 value = convertMetersToFeet(idResult.feature.attributes["Pixel Value"]) + " ft";
				 if (idResult.feature.attributes["Pixel Value"] =='NoData') {
								value = '> one mile';
					}
		  	 }     
              distadw.value = value;
              //modelvalues.distadw = value;
          	break;
          	case 14:
          	   if (!distwell.displayFieldName) {distwell.displayFieldName = idResult.layerName;};
               distwell.features.push(idResult.feature);
               if (idResult.feature.attributes["Pixel Value"]){
		  		 value = convertMetersToFeet(idResult.feature.attributes["Pixel Value"]) + " ft";
				 if (idResult.feature.attributes["Pixel Value"] =='NoData') {
					value = '> one mile';
					}
		  	 }     
              distwell.value = value;
              //modelvalues.distwell = value;
               
          	break;
 
           	case 15:
             if (!disthqr.displayFieldName) {disthqr.displayFieldName = idResult.layerName;};
               disthqr.features.push(idResult.feature);
               if (idResult.feature.attributes["Pixel Value"]){
		  		 value = convertMetersToFeet(idResult.feature.attributes["Pixel Value"]) + " ft";
				 if (idResult.feature.attributes["Pixel Value"] =='NoData') {
						value = '> one mile';
						}
		  	 }     
              disthqr.value = value;
              //modelvalues.disthqr = value;
          	break;
	
          	case 16:
          	 if (!distmajorsrcriver.displayFieldName) {distmajorsrcriver.displayFieldName = idResult.layerName;};
               distmajorsrcriver.features.push(idResult.feature);
               if (idResult.feature.attributes["Pixel Value"]){
		  		 value = convertMetersToFeet(idResult.feature.attributes["Pixel Value"]) + " ft";
				 if (idResult.feature.attributes["Pixel Value"] =='NoData') {
					value = '> one mile';
					}
		  	 }     
              distmajorsrcriver.value = value;
              //modelvalues.distmajorsrcriver = value;
          	break;
          	case 17:
		     if (!distmajorsrclake.displayFieldName) {distmajorsrclake.displayFieldName = idResult.layerName;};
               distmajorsrclake.features.push(idResult.feature);
               if (idResult.feature.attributes["Pixel Value"]){
		  		 value = convertMetersToFeet(idResult.feature.attributes["Pixel Value"]) + " ft";
				 if (idResult.feature.attributes["Pixel Value"] =='NoData') {
								value = '> one mile';
								}
		  	 }     
              distmajorsrclake.value = value;
              //modelvalues.distmajorsrclake= value;
          	break;
           	case 18:
              if (!distwatersrc.displayFieldName) {distwatersrc.displayFieldName = idResult.layerName;};
               distwatersrc.features.push(idResult.feature);
               if (idResult.feature.attributes["Pixel Value"]){
		  		 value = convertMetersToFeet(idResult.feature.attributes["Pixel Value"]) + " ft";
				 if (idResult.feature.attributes["Pixel Value"] =='NoData') {
								value = '> one mile';
								}
		  	 }     
              distwatersrc.value = value;
              //modelvalues.distwatersrc = value;
          	break;         	

          	case 19:
          	  if (!distpublicuseland.displayFieldName) {distpublicuseland.displayFieldName = idResult.layerName;};
               distpublicuseland.features.push(idResult.feature);
               if (idResult.feature.attributes["Pixel Value"]){
		  		 value = convertMetersToFeet(idResult.feature.attributes["Pixel Value"]) + " ft";
				 if (idResult.feature.attributes["Pixel Value"] =='NoData') {
								value = '> one mile';
								}
		  	 }     
              distpublicuseland.value = value;
              //modelvalues.distpublicuseland = value;
          	
          	break;

          	case 20:
          	  if (!wetland.displayFieldName) {wetland.displayFieldName = idResult.layerName;};
              wetland.features.push(idResult.feature);
              if (idResult.feature.attributes["BUFFERDIS"]){
		  		 //value = idResult.feature.attributes["BUFFERDIS"];
					value = "< 2500 ft";
		  	 		}  else {
		  	 	 	value = "> 2500 ft";
		  	 		}   
              wetland.value = value;
              //modelvalues.wetland = value;
          	break;

          	case 25:  
          	  if (!alluvial.displayFieldName) {alluvial.displayFieldName = idResult.layerName;};
              alluvial.features.push(idResult.feature);
              value = "No";
              if (idResult.feature.attributes["Pixel Value"] === "1"){
				value = "Alluvial Aquifer";
		  	 }
		  	  if (idResult.feature.attributes["Pixel Value"] === "2"){
				value = "Alluvial Soil";
		  	 }   
               alluvial.value = value;
               //modelvalues.alluvial = value;
          	break;

          	case 21:
          	  value = "Not in potential karst area";
          	  if (!distkarst.displayFieldName) {distkarst.displayFieldName = idResult.layerName;};
              distkarst.features.push(idResult.feature);
              if (idResult.feature.attributes["Pixel Value"]){
		  		 rastervalue = idResult.feature.attributes["Pixel Value"];
		  		 if (rastervalue === "1"){
		  		 	value = "Karst or within 1,000 ft of sinkhole";
		  		 }else if (rastervalue === "2"){
		  		    value = "Potential karst";	
		  		 }
		  	 }     
               distkarst.value = value;
               //modelvalues.distkarst = value;
              
          	break;
          	
          	case 22:
          	  if (!pctslope.displayFieldName) {pctslope.displayFieldName = idResult.layerName;};
              pctslope.features.push(idResult.feature);
              if (idResult.feature.attributes["Pixel Value"]){
		  		 value = idResult.feature.attributes["Pixel Value"];
		  	 }     
               pctslope.value = value;
               //modelvalues.pctslope = value;
          	break;
            case 23:
            	if(!burialvalue.displayFieldName){burialvalue.displayFieldName = idResult.layerName;};
            	burialvalue.features.push(idResult.feature);
            if (idResult.feature.attributes["Pixel Value"]){
		  		 rastervalue = idResult.feature.attributes["Pixel Value"];
		  		 if (rastervalue === "1"){
		  		    value = "Low Risk";	
		  		 }else if (rastervalue === "2"){
		  		    value = "Medium Risk";	
		  		 }else if (rastervalue === "3"){
		  		    value = "High Risk";	
		  		 }else {
		  		 	value = "N/A";
		  		 }
		  	 }     
               burialvalue.value = value;              
          	break;
          
          }
        }
        //dijit.byId("modelTab").setContent(makeContent(modelvalues,"modelresults"));
		//infoWindow.setContent(makeContent(modelvalues,"modelresults"));
        
        var modelpackage=[];
        modelpackage["location"] = pinlocation;
        modelpackage["afofacility"] = afofac;
        modelpackage["afodatabase"] = afodb;
        modelpackage["distadw"] = distadw;
		modelpackage["distwell"] = distwell;
		modelpackage["alluvial"] = alluvial;
		modelpackage["wetland"] = wetland;
		modelpackage["distwatersrc"] = distwatersrc;
		modelpackage["distmajorsrcriver"] = distmajorsrcriver;
		modelpackage["distmajorsrclake"] = distmajorsrclake;
		modelpackage["disthqr"] = disthqr;
		modelpackage["distkarst"] = distkarst;
		modelpackage["distadw"] = distadw;
		modelpackage["pctslope"] = pctslope;
		modelpackage["distpublicuseland"] = distpublicuseland;
		modelpackage["burialvalue"] = burialvalue;
     
        
       //TODO: Switch this to the mustache renderer.
        //infoWindow.setContent(makeContent(modelpackage,"modelresults"));
        //var windowposition = new Object();
        //windowposition.x = map.width - 225;
        //windowposition.y = -6;
        //infoWindow.show(windowposition);
        var afocontent = makeContent(modelpackage,"modelresults");
        return afocontent;
      }
      
      function makeContent(layerResults, layerName){      	
      	var mcontent = "";
      	mcontent += "<table class='modeltable'>";
      	//content +=  "<tr><td>Location</td><td>" + layerResults["location"].lon + " " + layerResults["location"].lat + "</td></tr>";
      	mcontent +=  "<tr><td>Ag Drainage Well Distance</td><td>" + layerResults["distadw"].value + "</td></tr>";
        mcontent +=  "<tr><td>Well Distance</td><td>" + layerResults["distwell"].value + "</td></tr>";
        mcontent +=  "<tr><td>Alluvial Soils present</td><td>" + layerResults["alluvial"].value+ "</td></tr>";
        mcontent +=  "<tr><td>Distance to surface water</td><td>" + layerResults.distwatersrc.value + "</td></tr>";
        mcontent +=  "<tr><td>Distance to Major Source River</td><td>" + layerResults.distmajorsrcriver.value + "</td></tr>";
        mcontent +=  "<tr><td>Distance to Major Source Lake</td><td>" + layerResults.distmajorsrclake.value + "</td></tr>";
        mcontent +=  "<tr><td>Distance to HQ/HQR water</td><td>" + layerResults.disthqr.value + "</td></tr>";
        mcontent +=  "<tr><td>Karst features</td><td>" + layerResults.distkarst.value+ "</td></tr>";
      	mcontent +=  "<tr><td>Designated Wetland Distance</td><td>" + layerResults.wetland.value + "</td></tr>";        
      	mcontent +=  "<tr><td>Percent slope</td><td>" + layerResults.pctslope.value + " %</td></tr>";
        mcontent +=  "<tr><td>Distance to public land</td><td>" + layerResults.distpublicuseland.value + "</td></tr>";   	        	      	    	
      	//mcontent +=  "<tr><td>Burial Zone Advisory</td><td>" + layerResults.burialvalue.value + "</td></tr>"; 
		mcontent += wellInfo; 
		console.log(wellInfo);
      	
      	if (layerResults.afofacility.value){
      	  mcontent += "<tr colspan='2'><td align='center'><strong>AFO/CAFO Info</strong></td></tr>";
      	  mcontent += "<tr><td>FacilityExplorer</td><td>AFO DB</td></tr>";
      	  for (var f in layerResults.afofacility.features){
      			feval = layerResults.afofacility.features[f].attributes.stfacid;
      			afoval = layerResults.afofacility.features[f].attributes.progid;
      		    mcontent +=  "<tr><td><a href='https://facilityexplorer.iowadnr.gov/FacilityExplorer/SiteDetail.aspx?facID=" + feval +  "' target='_blank' >" + feval + "</a></td>";
				mcontent += "<td><a href='https://programs.iowadnr.gov/animalfeedingoperations/FacilitySummary.aspx?FacilityId=" + afoval +  "' target='_blank' >" + afoval + "</a></td></tr>";
      		}
      	 }
      	mcontent += "</table>";
      	mcontent += "<p>Distances are estimates based on best available data. Distance calculations are &#177;37 ft.</p>";
      	mcontent += "<hr>";
      	mcontent += "<a href='https://www.iowadnr.gov/Environment/LandStewardship/AnimalFeedingOperations/Mapping/ProperAFOSiting.aspx' target = '_blank'>Proper AFO Siting</a><br />";
      	mcontent += "<a href='https://www.iowadnr.gov/portals/idnr/uploads/afo/hqwr2.pdf' target = '_blank'>High Quality Waters information</a><br />";
      	mcontent += "<a href='https://www.iowadnr.gov/Portals/idnr/uploads/afo/files/Alluvial-Karst%20determinations-Final1-24-12%20w%20links.pdf' target = '_blank'>Alluvial and Karst Determinations</a><br /><br />";  
      
      	//mcontent += footerContent(); 
      	return mcontent;
      }
      function footerContent()
      {
      	var fcontent = "";
      	fcontent += "<p>Distances are estimates based on best available data. Distance calculations are &#177;37 ft.</p>";
      	fcontent += "<hr>";
      	fcontent += "<a href='https://www.iowadnr.gov/Environment/LandStewardship/AnimalFeedingOperations/Mapping/ProperAFOSiting.aspx' target = '_blank'>Proper AFO Siting</a><br />";
      	fcontent += "<a href='https://www.iowadnr.gov/portals/idnr/uploads/afo/hqwr2.pdf' target = '_blank'>High Quality Waters information</a><br />";
      	fcontent += "<a href='https://www.iowadnr.gov/Portals/idnr/uploads/afo/files/Alluvial-Karst%20determinations-Final1-24-12%20w%20links.pdf' target = '_blank'>Alluvial and Karst Determinations</a><br /><br />";   	
 		//fcontent +="<hr>";
		//fcontent +=infoContent;
		return fcontent;     	
      }
      function showResults(r){
	    console.log(r); 
      	var results = [];
      	var content = "";        
        placeIdentifyLocationMarker();

        var viewdata = {};
        viewdata.lon = pinlocation["lon"];
	   	viewdata.lat = pinlocation["lat"];
	   	switch (app.activepintool){
	   		case "projecttool":
	   			headertemplate = "<img src='js/gov/iowadnr/compactmap/images/OrangePin16.png' />";
	   			section = "p0";
	   			break;
	   		case "draintool":
	   			headertemplate = "<img src='js/gov/iowadnr/compactmap/images/BluePin16.png' />";
	   			section = "p1";
	   			break;
	   	    
	   	    default:
	   	        headertemplate = "";
	   		
	   	}
		//app.activepintool = null;
	   	headertemplate += "{{lon}} {{lat}}<hr />";
	   	content = renderTemplate(headertemplate,viewdata);
        
        //TODO: Make the templates.
        //r[0] needs to be sent to the addToMap(idResults) function
        //r[1] needs to have a mustache template yes this is a mess.
        
         //WELL DATA
         var v = createViewData (app.IDENTIFYCONFIG[1].layerfieldmapping,r[1][1]);
         //console.log(v);
         content += renderTemplate(app.IDENTIFYCONFIG[1].infotemplate,v);
         //AFO MODEL
         content += afoModelContent(r[0][1]); 
         //content +="<hr>";
		 console.log(infoContent);
		 console.log(wellInfo);
		 content +=infoContent; 
		 content +=wellInfo;
         
        fcontent = ""; 
      	fcontent += "<p>Distances are estimates based on best available data. Distance calculations are &#177;37 ft.</p>";
      	fcontent += "<hr>";
      	fcontent += "<a href='https://www.iowadnr.gov/Environment/LandStewardship/AnimalFeedingOperations/Mapping/ProperAFOSiting.aspx' target = '_blank'>Proper AFO Siting</a><br />";
      	fcontent += "<a href='https://www.iowadnr.gov/portals/idnr/uploads/afo/hqwr2.pdf' target = '_blank'>High Quality Waters information</a><br />";
      	fcontent += "<a href='https://www.iowadnr.gov/Portals/idnr/uploads/afo/files/Alluvial-Karst%20determinations-Final1-24-12%20w%20links.pdf' target = '_blank'>Alluvial and Karst Determinations</a><br /><br />";  
      	
      	//content += fcontent; 
         
         
         
         
               
         // content += footerContent();
         
         // for (i=0; i<r.length;i++)
         // {
         	// console.info(r[i]);
 		  // //var v = createViewData (app.IDENTIFYCONFIG[i].layerfieldmapping ,r[i][1]);
        	// //      content += renderTemplate(app.IDENTIFYCONFIG[i].infotemplate,v);
          // }
	   	setInfoWindowContent(content,section);
      } 
    function placeIdentifyLocationMarker()
      {
      	switch (app.activepintool)
      	{
      		case "projecttool":
	      		removePin("pin0");
	      		symbol = orangePin;
	      		pinlocation = {"lon":null, "lat":null, "id":"pin0"};
      		break;	
      		case "draintool":
	      		removePin("pin1");
	      		symbol = bluePin;
	      		pinlocation = {"lon":null, "lat":null, "id":"pin1"};
      		break;
      		
      		default:
	      		map.graphics.clear();
	      		symbol = orangePin;
	      		pinlocation = {"lon":null, "lat":null, "id":"pin0"};
      		break;
      	}
      	var lon = identifyParams.geometry.getLongitude();
      	var lat = identifyParams.geometry.getLatitude();
      	
      	pinlocation["lon"] = lon.toFixed(6);
      	pinlocation["lat"] = lat.toFixed(6);
		pt = new esri.geometry.Point(identifyParams.geometry.x,identifyParams.geometry.y,map.spatialReference);
      	g = new esri.Graphic(pt,symbol,pinlocation,null);
      	map.graphics.add(g);
      }
      
     function removePin(pinid)
      {
      	for (g in map.graphics.graphics)
      	{
      		if (map.graphics.graphics[g].attributes && map.graphics.graphics[g].attributes.id === pinid)
      		{
      			map.graphics.remove(map.graphics.graphics[g]);
      		}
      	}
      }
      
     function createViewData (layerdefs,results){
      	var viewdata = new Object();
			for (l in layerdefs) {
			    for (lyr in results) {
			        if (layerdefs[l].layerId == results[lyr].layerId){
			           for (key in layerdefs[l].fieldmap){
			              if(results[lyr].feature.attributes.hasOwnProperty(key)){
			                viewdata[layerdefs[l].fieldmap[key]] = results[lyr].feature.attributes[key];
			              } else {
			              	
			              	//viewdata[layerdefs[l].fieldmap[key]]= layerdefs[l].fieldmap[key];
			              	viewdata[key]= layerdefs[l].fieldmap[key];
			              }
			           }
			        }
			    }
			}
      	return viewdata;
      } 
      
     function renderTemplate(template,viewdata)
      {
      	var output = Mustache.render(template, viewdata);
      	return output;
      }
      
   function setInfoWindowContent(stringcontent, section)
      {
      	//stringcontent += footerContent();
      	
      	if (dojo.byId(section))
      	{
      		dojo.destroy(section);
      		dojo.destroy(section+ "p");
      		dojo.create("div",{"id":section,"class":"infotab"},"pinDiv");
      		dojo.create("div",{"id":section+ "p","class":"infotab"},"pinDivPrint"); //Special div that is hidden until print css media query called
      	}else {
      		dojo.create("div",{"id":section,"class":"infotab"},"pinDiv");
      		dojo.create("div",{"id":section+ "p","class":"infotab"},"pinDivPrint"); //Special div that is hidden until print css media query called
      	}
      	
      	if(section==="p0"){
      		app.infowindowcontent["p0"]=stringcontent;
      		dojo.place(app.infowindowcontent["p0"],section);
      		dojo.place(app.infowindowcontent["p0"],section + "p");
      	} else if (section==="p1"){	
      		app.infowindowcontent["p1"]=stringcontent;
      		dojo.place(app.infowindowcontent["p1"],section);
      		dojo.place(app.infowindowcontent["p1"],section + "p");
      	}
      	
      	//Toggle pinTab
      	var pane = dijit.byId("pinTab");
      	var tabs = dijit.byId("tabContainer");
      	tabs.selectChild(pane);
      }
      
      function showCoordinates(evt) {
        var mp = evt.mapPoint;
        pt01 = transformCoordinate('EPSG:102100','EPSG:26915',mp.x,mp.y);
        pt02 = transformCoordinate('EPSG:102100','EPSG:4326',mp.x,mp.y);
        dojo.byId("divMapCoords").innerHTML = pt01.x.toFixed(2) + ", " + pt01.y.toFixed(2);
        dojo.byId("divTransformedCoords").innerHTML = pt02.x.toFixed(6) + ", " + pt02.y.toFixed(6);
      }
      function transformCoordinate(fromEPSG, toEPSG, x ,y){
      	var source = new Proj4js.Proj(fromEPSG);    //source coordinates will be in Longitude/Latitude
		var dest = new Proj4js.Proj(toEPSG);     //destination coordinates in LCC, south of France
		var p = new Proj4js.Point(x,y);   //any object will do as long as it has 'x' and 'y' properties
		return Proj4js.transform(source, dest, p);      //do the transformation.  x and y are modified in place
      }
      function locateAddress() {
      	map.graphics.clear();
        var address = {"SingleLine":dojo.byId("address").value};
        locator.outSpatialReference= map.spatialReference;
        locator.addressToLocations(address,["Loc_name"]);
      }
      function showGeocodeResults(candidates) {
        var candidate;
        var infoTemplate = new esri.InfoTemplate("Location", "Address: ${address}<br />Score: ${score}<br />Source locator: ${locatorName}");
        var geom;
       
        dojo.every(candidates,function(candidate){
          if (candidate.score > 80) {
            var attributes = { address: candidate.address, score:candidate.score, locatorName:candidate.attributes.Loc_name };  
            geom = candidate.location;

            var graphic = new esri.Graphic(geom, redPin, attributes, infoTemplate);
            map.graphics.add(graphic);
            return false; //break out of loop after one candidate with score greater  than 80 is found.
          }
        });
        if(geom !== undefined){
          map.centerAndZoom(geom,14);
        }
      }       	
	function addMeasurementWidget() {
	   var fp = new dojox.layout.FloatingPane({
	     title:"Measure",
	     resizable: false,
	     dockable: false,
	     closable: false,
	     style: "position:absolute;top:5px;left:5px;width:245px;height:175px;z-index:100;visibility:hidden;",
	     id: 'measurePane'
	   }, dojo.byId('measurePane'));
	   fp.startup();
	
	   var titlePane = dojo.query('#measurePane .dojoxFloatingPaneTitle')[0];
	   //add close button to title pane
	   var closeDiv = dojo.create('div', {
	     id: "closeBtn",
	     innerHTML:  esri.substitute({close_title:"close",close_alt:"close"},'<a alt=${close_alt} title=${close_title} href="JavaScript:toggleMeasure();"><img  src="https://programs.iowadnr.gov/maps/apis/idnr/js/gov/iowadnr/compactmap/images/close.png"/></a>')
	   }, titlePane);
	
	   measure = new esri.dijit.Measurement({
	     map: map,
	     id: 'measureTool',
	     defaultAreaUnit: esri.Units.ACRES,
	     defaultLengthUnit: esri.Units.FEET
	   }, 'measurementDiv');
	
	   measure.startup();
	   var measureButton = new dijit.form.ToggleButton({
	     label: "Measure",
	     title: "Measure", 
	     id: "measureButton",
	     iconClass: "esriMeasureIcon",
	     baseClass: "dnrToolButton"
	   });

	   dojo.connect(measureButton, "onClick", function () {
	     toggleMeasure();
	   });
	
	   dojo.byId('header-toolbar').appendChild(measureButton.domNode);
	 }
  
     function addMailMapButton(){
  		 var mailButton = new dijit.form.ToggleButton({
	     label: "Mail",
	     title: "Mail location", 
	     id: "mailButton",
	     iconClass: "dnrMailIcon",
	     baseClass: "dnrToolButton"
	    });
	
	   dojo.connect(mailButton, "onClick", function () {
	     toggleMail();
	   });
	
	   dojo.byId('header-toolbar').appendChild(mailButton.domNode);
    }
    function addSplashButton(){
  	var splashButton = new dijit.form.ToggleButton({
	     label: "Map Info",
	     title: "Map Info", 
	     id: "showsplash",
	     iconClass: "dnrSplashIcon",
	     baseClass: "dnrToolButton"
	    });
	   dojo.connect(splashButton, "onClick", function () {
	     showSplash();
	   });	
	   dojo.byId('header-toolbar').appendChild(splashButton.domNode);	
    }

   

   function toggleMail(){
  	baseurl = "https://" + window.location.hostname + window.location.pathname;  	
    baseurl += "%3F";
    if (map.graphics.graphics.length > 0 && map.graphics.graphics[0].attributes["id"] === "pin0"){
    	loc = map.graphics.graphics[0].attributes["lon"] +"," + map.graphics.graphics[0].attributes["lat"];
    	zoom = map.getZoom();
        baseurl += "%26pin=1";
    } else {
    	tpt = transformCoordinate('EPSG:102100','EPSG:4326',map.extent.getCenter().x,map.extent.getCenter().y);
    	loc = tpt.x.toFixed(6) +"," + tpt.y.toFixed(6);
    	zoom = map.getLevel();
    	}
    
  	
  	baseurl += "%26pin0=" + loc;
  	baseurl += "%26z=" + zoom;
  	bodytext = "Information for the following coordinates: " + loc;
  	window.location = "mailto:?subject=AFO Siting Location&body=" + bodytext + "%0D%0A" + baseurl ;
  }
  
  
  function createBasemapGallery(default_basemap){
      basemap_gallery = createWebMercatorGallery();
      //basemap_gallery.startup();
      selectionHandler = dojo.connect(basemap_gallery,"onSelectionChange",function(){
          		dojo.disconnect(selectionHandler);
          		map.addLayers(maplayers.reverse());
      });
      
      //FORCE selectionChange to add layers, API throws an error since we are using all Bing Maps otherwise. 
      //dijit.byId(basemap_gallery.id).onSelectionChange();

   }
	function showSplash(){
		//dijit.byId("splash").show();
	}
	function hideSplash() {
		dijit.byId("splash").hide();
	}
    function enablePopups() {
              if (clickListener) {
                     clickHandler = dojo.connect(map, "onClick", clickListener);
              }
       }
    function disablePopups() {
          if (clickHandler) {
            dojo.disconnect(clickHandler);
            clickHandler = null;
          }
       }
 function toggleMeasure() {
   if (dojo.byId('measurePane').style.visibility === 'hidden') {
     dijit.byId('measurePane').show();
     disablePopups();
     map.hideZoomSlider();
   } else {
     dijit.byId('measurePane').hide();
     enablePopups();
     map.showZoomSlider();
     dijit.byId('measureButton').set('checked', false);
     var measure = dijit.byId('measureTool');
     measure.clearResult();
     if (measure.activeTool) {
       measure.setTool(measure.activeTool, false);
     }
   }
 }
function convertMetersToFeet(length){
	length = parseInt(length * 3.28084); 
	return length;
}
function sortAscending(property) {
	return function (a,b) {
	return (a[property] < b[property]) ? -1 : (a[property] > b[property]) ? 1 : 0;
	};
}
function sortDescending(property) {
	return function (a,b) {
	return (a[property] > b[property]) ? -1 : (a[property] < b[property]) ? 1 : 0;
	};
}

function stringToBoolean(string){
	switch(string.toLowerCase()){
		case "true": case "yes": case "1": return true;
		case "false": case "no": case "0": case null: return false;
		default: return false;
	}
}

function doIdentify2(evt) {
		infoContent = ""; //define outside function on top 
		//let mp = webMercatorUtils.webMercatorToGeographic(evt.mapPoint);
		//infoContent += "X,Y: " + mp.x.toFixed(4) + ", " + mp.y.toFixed(4) + "<br>";


		//if (map.getScale() > 50000) {
		//	alert("Please zoom in until you see the current map scale at lower left\nturn blue or the scale bar showing 0.2mi or smaller; then click to see result.");
		//	return;
		//}
		//console.log(evt);
		//map.graphics.clear();
		// markerSymbol is used for point and multipoint, see http://raphaeljs.com/icons/#talkq for more examples
		//var markerSymbol = new SimpleMarkerSymbol();
		//markerSymbol.setPath("M16,4.938c-7.732,0-14,4.701-14,10.5c0,1.981,0.741,3.833,2.016,5.414L2,25.272l5.613-1.44c2.339,1.316,5.237,2.106,8.387,2.106c7.732,0,14-4.701,14-10.5S23.732,4.938,16,4.938zM16.868,21.375h-1.969v-1.889h1.969V21.375zM16.772,18.094h-1.777l-0.176-8.083h2.113L16.772,18.094z");
		//markerSymbol.setColor(new Color("#00FFFF"));
	
		//map.graphics.add(new Graphic(evt.mapPoint, sms));
		console.log(evt);
		burialLayer = "https://programs.iowadnr.gov/geospatial/rest/services/Agriculture/Burial/MapServer";
		map.addLayer(new esri.layers.ArcGISDynamicMapServiceLayer(burialLayer, { 
				"visible": false,
				"opacity": 0.9 }));
		//let identifyTask = new IdentifyTask(burialLayer);
		let identifyTask = new esri.tasks.IdentifyTask(burialLayer);
		let identifyParams = new esri.tasks.IdentifyParameters();
		identifyParams.tolerance = 3;
		//identifyParams.spatialReference = new esri.SpatialReference({"wkid":26915});
		identifyParams.returnGeometry = false;
		//identifyParams.layerIds = [3,4,5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25,26,27]; 
		identifyParams.layerOption =  esri.tasks.IdentifyParameters.LAYER_OPTION_ALL;  //redundancy with the layerIds.
		identifyParams.width = map.width;
		identifyParams.height = map.height
		identifyParams.geometry = evt.mapPoint;

		identifyParams.mapExtent = map.extent;

		//let burialZone ="";
		// let alluvial, publicWaterSupply, insideCities, wetland, conservationEasement, floodArea, floodPlain;
		// let waterProtectionZone, woodyVegetation, NHD,publicLand, PrivateWellPermit;

		var deferred = identifyTask
			.execute(identifyParams)
			.addCallback(function (response) {
				// response is an array of identify result objects
				// Let's return an array of features.
				console.log(response);
				//dojo._base.array
				//let arrValues = arrayUtils.map(response, function (result) {
			 //require(["dojo/_base/array"], function(arrayUtil) {
				let arrValues = dojo._base.array.map(response, function (result) {
				//let arrValues = arrayUtil.map(response, function (result) {	
					var feature = result.feature;
					var layerName = result.layerName;
					let layerId = result.layerId;
					//console.log("LayerID: "+layerId);
					//feature.attributes.layerName = layerName;
					//console.log(result.layerId);
					if (layerId === 2) {
						//burialZone = "${feature.attributes['Pixel Value']}";
						//burialZone = "${CATEGORY}";						
						infoContent += `Burial Zone Regulatory: ${feature.attributes['DESCR_']} <br>`;
					}
					else if (layerId === 3) {
					
						infoContent += `Burial Zone Advisory: ${feature.attributes['CATEGORY']} Risk</br>`;						
					} 
					else if (layerId === 4) {						
						infoContent += `Public Water Supply - Non-Municipal: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					} else if (layerId === 5) {
						
						infoContent += `Inside Cities: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					} else if (layerId === 6) {
						
						infoContent += `Surface Water Set-back - Wetland: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					} else if (layerId === 27) {
						infoContent += `Surface Water Set-back - Streams: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					}
					else if (layerId === 7) {
						
						infoContent += `Conservation Easements: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					} else if (layerId === 8) {
						
						infoContent += `Sinkholes: ${feature.attributes['Pixel Value'] == 1 ? ' Yes' : ' No'}<br>`;
					} else if (layerId === 9) {
						
						infoContent += `Steep Slopes: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					} else if (layerId === 10) {
						
						infoContent += `Floodplain Area:  ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					} else if (layerId === 11) {
						
						infoContent += `Floodplain:${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					} else if (layerId === 12) {
						
						infoContent += `Source Water Protection Zones: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					} else if (layerId === 13) {
						
						infoContent += `Woody Vegetation: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					} else if (layerId === 14) {
						
						infoContent += `Public Water Supplies - Municipal: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					} else if (layerId === 15) {
						
						infoContent += `NHD: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					
					} else if (layerId === 16) {
						
						infoContent += `Steep Slopes: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					} else if (layerId === 17) {
						
						infoContent += `Private Permitted Wells: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					}
					else if (layerId === 18) {

						infoContent += `Excessively Drained: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					}
					else if (layerId === 19) {

						infoContent += `Flood Frequency: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					}
					else if (layerId === 20) {

						infoContent += `Moderate Slopes: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					}
					else if (layerId === 21) {

						infoContent += `Ponded Soils: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					}
					else if (layerId === 22) {

						infoContent += `Depth to Seasonal High Water Table (SHWT): ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					}
					else if (layerId === 23) {

						infoContent += `Landscape Position: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					}
					else if (layerId === 24) {

						infoContent += `Landscape Position - Upland Drainages: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					}
					else if (layerId === 25) {
						infoContent += `Shallow Depth to Bedrock: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					}

					else if (layerId === 26) {
						infoContent += `Ag Drainage Wells: ${feature.attributes['Pixel Value'] == 1 ? 'Yes' : 'No'}<br>`;
					}
					return feature;
				
				 });
				//})
				
				//infoContent += "<a href='https://www.iowadnr.gov/Environment/LandStewardship/AnimalFeedingOperations/Mapping/ProperAFOSiting.aspx' target = '_blank'>Proper AFO Siting</a><br />";
				//infoContent += "<a href='https://www.iowadnr.gov/portals/idnr/uploads/afo/hqwr2.pdf' target = '_blank'>High Quality Waters information</a><br />";
				//infoContent += "<a href='https://www.iowadnr.gov/Portals/idnr/uploads/afo/files/Alluvial-Karst%20determinations-Final1-24-12%20w%20links.pdf' target = '_blank'>Alluvial and Karst Determinations</a><br /><br />"; 
				
				//map.infoWindow.setContent(infoContent);
				//map.infoWindow.resize(400, 620);
				//map.infoWindow.show(evt.mapPoint, map.getInfoWindowAnchor(evt.screenPoint));
				console.log(infoContent);
				setTimeout(function(){
					if ((document.getElementById("p0").innerHTML).indexOf("Burial Zone")<0){
					document.getElementById("p0").innerHTML += infoContent;
					}
				},600);
				
				//console.log(infoContent);
			});
			//return infoContent; 
			
	} 
	
 dojo.addOnLoad(init);
 //document.getElementById("layerListDom_checkbox_0").checked = false;
</script>
</head>
<body class="nihilo">
<div id="main" style="height:95%"><div class="dijitHidden">
<div data-dojo-props="title:'Iowa Department of Natural Resources',href:'splash.html',loadingMessage:'loading map...'" data-dojo-type="dijit.Dialog" id="splash" title="Livestock Burial Siting Disclaimer and Help"></div>
</div>
<div data-dojo-props="design:'headline',gutters:false" data-dojo-type="dijit.layout.BorderContainer" id="mainWindow" style="width: 100%; height: 100%; margin: 0;">
<div data-dojo-props="region:'top'" data-dojo-type="dijit.layout.ContentPane" id="header">
<div id="heading">
<a href="https://www.iowadnr.gov/" id="idnr_logo_link" title="Iowa Department of Natural Resources">
<img alt="Iowa Department of Natural Resources" id="idnr_logo" src="https://programs.iowadnr.gov/maps/apis/idnr/js/gov/iowadnr/compactmap/images/logo_brown.png" style="border-width:0px;"/></a>
</div>
<div id="headtitle">Livestock Burial</div>
<div id="header-toolbar"> 
<!--<button id="legend"  type="button" class=" btn-header">Legend</button> -->
</div>
</div>
<div data-dojo-props="region:'left'" data-dojo-type="dojox.layout.ExpandoPane" id="leftPane" maxwidth="250" style="width:250px;">
<div data-dojo-props="attachParent:true,useMenu:false,tabStrip:false,useSlider:false,minSize:25" data-dojo-type="dijit.layout.TabContainer" id="tabContainer">
<div data-dojo-props="title:'Legend'" data-dojo-type="dijit.layout.ContentPane" id="legendPane">
<div id="legendDiv"></div>
</div>
<div data-dojo-props="title:'Map layers'" data-dojo-type="dijit.layout.ContentPane" id="layersTab">
<div id="tocDiv"></div>
</div>
<div data-dojo-props="title:'Info'" data-dojo-type="dijit.layout.ContentPane" id="pinTab">
<div id="pinDiv"></div>
</div>
</div>
</div>
<div class="shadow" data-dojo-props="region:'center'" data-dojo-type="dijit.layout.ContentPane" id="map">
<div id="ds">
<div id="ds-h">
<div class="ds h1 o1"></div>
<div class="ds h2 o2"></div>
<div class="ds h3 o3"></div>
<div class="ds h4 o4"></div>
<div class="ds h5 o5"></div>
</div>
<div id="ds-l">
<div class="ds v1 o1"></div>
<div class="ds v2 o2"></div>
<div class="ds v3 o3"></div>
<div class="ds v4 o4"></div>
<div class="ds v5 o5"></div>
</div>
</div>
<div id="measurePane">
<div id="measurementDiv"> </div>
</div>
</div>
<div id="layerListDom"></div>
<div id="legend"></div>
<div data-dojo-props="region:'bottom'" data-dojo-type="dijit.layout.ContentPane" id="footer">
<div id="footer-toolbar">
<div id="address-search">
<input class="searchinput" id="address" placeholder="502 E. 9th St, Des Moines, IA 50319" type="text"/>
<input class="searchbutton" id="search-address" src="https://programs.iowadnr.gov/maps/apis/idnr/js/gov/iowadnr/compactmap/images/blank.gif" type="image"/>
<div data-dojo-props="connectId:'address',position:['above']" data-dojo-type="dijit.Tooltip" style="display: none;">
<table cellpadding="2" width="280">
<caption><b>Address Search</b></caption>
<tr><td><i>Example</i></td><td><i>502 E. 9th St, Des Moines, IA 50319</i></td></tr>
</table>
</div>
</div>
<div id="plss-search">
<input class="searchinput" id="plss" placeholder="T95NR45W02" type="text"/>
<input class="searchbutton" id="search-plss" src="https://programs.iowadnr.gov/maps/apis/idnr/js/gov/iowadnr/compactmap/images/blank.gif" type="image"/>
<div data-dojo-props="connectId:'plss',position:['above']" data-dojo-type="dijit.Tooltip" style="display: none;">
<table cellpadding="2" width="225">
<caption><b>Township-Range-Section Search</b></caption>
<tr><td>Township</td><td><b>T</b>65 - 100<b>N</b></td></tr>
<tr><td>Range</td><td><b>R</b>01 - 07<b>E</b></td></tr>
<tr><td></td><td><b>R</b>01 - 49<b>W</b></td></tr>
<tr><td>Section</td><td>01 - 36</td></tr>
<tr><td></td><td></td></tr>
<tr><td><i>Example</i></td><td><i>T84NR03E02</i></td></tr>
</table>
</div>
</div>
<div id="footercoords">
<div class="coords">UTM Zone 15 NAD83<div id="divMapCoords">x,y</div></div>
<div class="coords">WGS84<div id="divTransformedCoords">x,y</div></div>
<!--<div class="coords">Current Map Scale<div id="numScale">00</div></div> -->
</div>
<span class="coords" id="numScale">Map Scale</span>&nbsp &nbsp &nbsp 

<span>
    <input type="text" id="searchSiteByProjectID" style="width: 150px;" placeholder="12345" title="Type in an facility ID, a five digit number." />
    <button id="searchProjectID">Search</button>
</span>
</div>
</div>
</div>
<div id="pinDivPrint"></div>
</div>
</body>
</html>